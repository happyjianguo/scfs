<html>

<head>
<title>入库单打印</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- FontAwesome 4.3.0 -->
<link href="../../../fonts/font-awesome-4.4.0/css/font-awesome.min.css"
	rel="stylesheet" type="text/css" />
<!-- Ionicons 2.0.1 -->
<link href="../../../fonts/ionicons-2.0.1/css/ionicons.min.css"
	rel="stylesheet" type="text/css" />
<!--bootstrap-->
<link href="../../../css/bootstrap_min.css" rel="stylesheet"
	type="text/css" />
<!--AdminLTE theme-->
<link href="../../../css/AdminLTE_min.css" rel="stylesheet"
	type="text/css" />
<!-- <link href="css/AdminLT_skins/_all-skins.min.css" rel="stylesheet" type="text/css" /> -->
<link href="../../../css/jquery.tag-editor.css" rel="stylesheet"
	type="text/css" />
<!--web css-->
<link rel="stylesheet"
	href="../../../js/plugins/jquery.datetimepicker/jquery.datetimepicker.css">
<link rel="stylesheet" href="../../../css/sys_setting_min.css">
<link rel="stylesheet" href="../../../css/mainframe_min.css">
<link rel="stylesheet" href="../../../css/common.css">
<link rel="stylesheet"
	href="../../../js/plugins/bootstrap-table/bootstrap-table.min.css">
<style type="text/css">
@page {
	size: auto; /* auto is the initial value */
	margin: 0mm; /* this affects the margin in the printer settings */
}

body, table {
	font-size: 12px;
}

table {
	margin: auto;
}

table.head {
	font-size: 13px;
	margin-top: -5px;
}

table.head td {
	height: 10px;
	overflow: hidden;
	white-space: nowrap;
}

div.whole {
	margin: 0px auto;
	padding-top: 30px;
	width: 730px;
}

td {
	vertical-align: middle;
}

hr {
	margin: 5px 0 2px 0;
}

#qrcode img {
	vertical-align: middle;
	margin: auto;
}
</style>
</head>

<body>
	<div class="whole">
		<div class="print-top">
			<button class="btn btn-primary mb20 printBtn">打印</button>
			<button class="btn btn-default mb20 closeBtn">关闭</button>
		</div>
		<form class="form-horizontal form-inline" id="form1"
			data-url="billInStore/detail">
			<table width="710px">
				<tr>
					<td>
						<table width="100%">
							<tr>
								<td align="center">
									<h3>
										<label class="js-initform" id="businessUnitName"
											name="businessUnitName" />
									</h3>
									<hr> <span><label class="js-initform"
										id="companyInfo" name="companyInfo" /></span>
								</td>
							</tr>
							<tr>
								<td align="center" style="font-size: 20px; padding: 10px;"><strong>入库单</strong>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td></td>
				</tr>
				<tr>
					<td>
						<table class="print-table" style="width: 99%">
							<tr>
								<td style="border: 0; padding: 0px; text-align: left;">客户名称：<label
									class="js-initform" id="fullSupplierName"
									name="fullSupplierName"></label></td>
								<td style="border: 0; padding: 0px; text-align: right;">入库编号：<label
									class="js-initform" id="billNo" name="billNo"></label></td>
							</tr>
							<tr>
								<td style="border: 0; padding: 0px; text-align: left;">收货单位：<label
									class="js-initform" id="businessUnitName"
									name="businessUnitName"></label></td>
								<td style="border: 0; padding: 0px; text-align: right;">日期：<label
									class="js-initform" id="receiveDate" name="receiveDate"></label></td>
							</tr>
						</table>
					</td>
				</tr>
				<br />
				<tr>
					<td colspan="4" style="border: 0; padding: 15px 0">
						<table width="100%" style="border: 0; border-collapse: collapse;"
							class="billInStore_table">
							<thead>
								<th
									style="border: 1px solid #000; padding: 5px; text-align: center; width: 35px">序号</th>
								<th
									style="border: 1px solid #000; padding: 5px; text-align: center;">sku</th>
								<th
									style="border: 1px solid #000; padding: 5px; text-align: center;">商品名称及型号</th>
								<th
									style="border: 1px solid #000; padding: 5px; text-align: center; width: 50px">数量</th>
								<th
									style="border: 1px solid #000; padding: 5px; text-align: center; width: 35px">单位</th>
								<th
									style="border: 1px solid #000; padding: 5px; text-align: center; width: 60px">箱数</th>
								<th
									style="border: 1px solid #000; padding: 5px; text-align: center; width: 50px">箱号</th>
								<th
									style="border: 1px solid #000; padding: 5px; text-align: center; width: 70px"">采购单号</th>
							</thead>
							<tbody>
							</tbody>
							<tfoot>
								<tr>
									<td
										style="border: 1px solid #000; padding: 5px; text-align: left;"
										colspan="3"><strong>合计:</strong></td>
									<td
										style="border: 1px solid #000; padding: 5px; text-align: center;"
										colspan="1"><label class="js-initform" id="receiveNum"
										name="receiveNum" /></td>
									<td
										style="border: 1px solid #000; padding: 5px; text-align: center;"
										colspan="1"></td>
									<td
										style="border: 1px solid #000; padding: 5px; text-align: center;"
										colspan="1"></td>
									<td
										style="border: 1px solid #000; padding: 5px; text-align: center;"
										colspan="1"></td>
									<td
										style="border: 1px solid #000; padding: 5px; text-align: center;"
										colspan="1"></td>
								</tr>
								<tr>
									<td
										style="border: 1px solid #000; padding: 5px; text-align: left;"
										colspan="5" rowspan="3">&nbsp;&nbsp;&nbsp;&nbsp;请按照本表托运单所列货物名称、件数签收。如果发生货损等异常情况，请在本表异常描述中详细说明。</td>
									<td
										style="border: 1px solid #000; padding: 5px; text-align: center;"
										colspan="1" rowspan="3">包装明细</td>
									<td
										style="border: 1px solid #000; padding: 5px; text-align: center;"
										colspan="2" rowspan="3">（         ）整卡板<br>（    
										    ）原装箱<br>（         ）散装箱
									</td>
								</tr>
								<tr>
								</tr>
								<tr>
								</tr>
								<tr>
									<td
										style="border: 1px solid #000; padding: 5px; text-align: left;"
										colspan="8"><strong>货物异常描述：</strong><br>
									<br>
									<br></td>
								</tr>
							</tfoot>

						</table>
					</td>
				</tr>
				<tr>
					<td>
						<table width="100%">
							<tr>
								<td height="15px" align="left">收货人地址：&nbsp; <label
									class="js-initform" id="warehouseAddressName"
									name="warehouseAddressName"></label>
								</td>
							</tr>
							<tr>
								<td height="15px" align="left">运输方式：&nbsp; <input
									type='text'
									style='background-color: transparent; border: none;'>
								</td>
							</tr>
							<tr>
								<td height="15px" align="left">运费支付：&nbsp; <input
									type='text'
									style='background-color: transparent; border: none;'>
								</td>
							</tr>
							<tr>
								<td height="15px" align="left">送货人：&nbsp; <input
									type='text'
									style='background-color: transparent; border: none;'>
								</td>
							</tr>
							<tr>
								<td height="15px" align="left">送货人身份证：&nbsp; <input
									type='text'
									style='background-color: transparent; border: none;'>
								</td>
							</tr>
							<tr>
								<td height="15px" align="left">送货人联系电话：&nbsp; <input
									type='text'
									style='background-color: transparent; border: none;'>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td>
						<table width="100%">
							<tr>
								<td height="15px" align="right" valign="bottom">单据填制人：<input
									disabled="disabled" type='text' class="js-initform"
									style='background-color: transparent; border: none; border-bottom: black solid 1px'
									id="creator"> &nbsp;日期：<input disabled="disabled"
									type='text' class="js-initform"
									style='background-color: transparent; border: none; border-bottom: black solid 1px'
									id="createAt">
								</td>
							</tr>
							<tr>
								<td height="15px" align="right" valign="bottom">收货人签名：<input
									disabled="disabled" type='text'
									style='background-color: transparent; border: none; border-bottom: black solid 1px'>
									&nbsp;日期：<input disabled="disabled" type='text'
									style='background-color: transparent; border: none; border-bottom: black solid 1px'>
								</td>
							</tr>
							<tr>
								<td height="15px" align="right" valign="bottom">收货单位盖章：<input
									disabled="disabled" type='text'
									style='background-color: transparent; border: none; border-bottom: black solid 1px'>
									&nbsp;日期：<input disabled="disabled" type='text'
									style='background-color: transparent; border: none; border-bottom: black solid 1px'>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</form>
	</div>
	<script src="../../../js/lib/jquery-1.9.1.min.js"
		type="text/javascript"></script>
	<script src="../../../js/lib/qrcode.min.js" type="text/javascript"></script>
	<script src='../../../js/plugins/bootstrap-table/bootstrap-table.js'
		type='text/javascript'></script>
	<script
		src='../../../js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js'
		type='text/javascript'></script>
	<script src='../../../js/plugins/layer/layer.js' type='text/javascript'></script>
	<script src="../../../js/common.js"></script>
</body>
<script>
		var id = GLOBAL.getParam("id");
		var editData = GLOBAL.getEditData($("#form1"), id);

		//生成二维码, qrcode为二维码容器div的id，二维码的内容由text属性值指定，此例为editData.orderNo
		if(editData){
			$("#companyInfo").text("电话：" + editData.businessUnitRegPhone);
			/**
			var qrcode = new QRCode("qrcode", {
			    text: editData.billNo,
			    width: 90,
			    height: 90,
			    colorDark : "#000000",
			    colorLight : "#ffffff",
			    correctLevel : QRCode.CorrectLevel.H
			});
			**/
		}

		GLOBAL.ajax("billInStoreDtl/all/query", {billInStoreId: id}, function(result) {
        	if (result.items) {
        		var tbody = "";
        		for (var i = 0; i < result.items.length; i++) {
        			var data = result.items[i];
        			var tr = "<tr>" + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> " + (i + 1) + "</td>";
        			if (data.goodsNumber) {
        				tr= tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> " + data.goodsNumber + "</td>";
        			} else {
        				tr= tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'></td>";
        			}
        			if (data.goodsName) {
        				if (data.goodsType) {
            				tr= tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> " + data.goodsName + "(" + data.goodsType + ")" + "</td>"
        				} else {
            				tr= tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> " + data.goodsName + "</td>"
        				}
        			} else {
        				tr = tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> </td>"
        			}
        			if (data.receiveNum) {
        				tr = tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> " + data.receiveNum + "</td>";
        			} else {
        				tr = tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> </td>"
        			}
        			if (data.goodsUnit) {
        				tr = tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> " + data.goodsUnit + "</td>"
        			} else {
        				tr = tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> </td>"
        			}
        			tr = tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> </td>"       			
        			tr = tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> </td>"  			
        			if (data.orderNo) {
        				tr = tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> " + data.orderNo + "</td>"
        			} else {
        				tr = tr + "<td style='border: 1px solid #000; padding: 5px; text-align: center;'> </td>"
        			}
        			tbody += tr;
                }
                $(".billInStore_table").find("tbody").append(tbody);             
        	}
	    });
        
		$(".printBtn").click(function(){
			$(this).parent(".print-top").hide();
			closeAfterPrint();
		})
		$(".closeBtn").click(function(){
			window.close();
		})

		function closeAfterPrint(){
			if(document.execCommand("print")){
				$(".print-top").show();
				GLOBAL.ajax("common/updatePrintNum", {id:id, billType:4}, function(){
					//layer.msg("打印次数 + 1");
				});
			}
			else setTimeout("CloseAfterPrint();",1000);
		}

		window.onafterprint = function(){
		   alert("Printing completed...");
		}

	</script>

</html>
